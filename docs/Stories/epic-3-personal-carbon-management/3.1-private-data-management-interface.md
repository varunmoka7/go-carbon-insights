---
id: 3.1-private-data-management-interface
title: Private Data Management Interface & Onboarding Flow
epic: Epic 3 â€“ Personal Carbon Management
phase: 3.1
status: planned
---

## Background
Epic 3 transforms GoCarbonTracker from a public research platform into a comprehensive personal carbon management tool. This story establishes the foundation for private data management, enabling users to track their organization's emissions data privately while leveraging public insights.

## User Story
**As a** new user exploring GoCarbonTracker,
**I want** to discover and access private carbon management features,
**so that** I can track my organization's emissions data privately while leveraging public insights.

## Acceptance Criteria

### Frontend Implementation Requirements

1. **Navigation Integration**
   - Add "Private Mode" toggle button in main navigation
   - Implement view mode indicator in header
   - Create smooth transition animations between modes
   - Ensure mobile-responsive navigation updates

2. **Onboarding Flow**
   - Welcome modal for first-time private mode users
   - Step-by-step organization setup wizard
   - Data upload tutorial and guidance
   - Feature discovery tour highlighting key capabilities

3. **Organization Profile Setup**
   - Organization creation form with validation
   - Company information input (name, industry, size)
   - Team member invitation system
   - Privacy settings configuration

4. **Data Upload Interface**
   - Drag-and-drop CSV/Excel file upload
   - Manual data entry form with validation
   - Progress indicators and error handling
   - Data preview and confirmation steps

## Technical Implementation Tasks

### New Components to Create

#### Navigation & View Switching
- [ ] `ViewModeToggle.tsx` - Main toggle between public/private modes
- [ ] `ViewModeIndicator.tsx` - Current mode display in header
- [ ] `NavigationUpdater.tsx` - Dynamic navigation based on mode

#### Onboarding Flow
- [ ] `PrivateModeOnboarding.tsx` - Welcome and setup wizard
- [ ] `OrganizationSetupWizard.tsx` - Step-by-step organization creation
- [ ] `DataUploadTutorial.tsx` - Interactive upload guidance
- [ ] `FeatureDiscoveryTour.tsx` - Highlight key private features

#### Organization Management
- [ ] `OrganizationProfileForm.tsx` - Company information input
- [ ] `TeamMemberInvitation.tsx` - Invite team members
- [ ] `PrivacySettingsPanel.tsx` - Configure data sharing preferences

#### Data Upload
- [ ] `DataUploadZone.tsx` - Drag-and-drop file upload
- [ ] `ManualDataEntryForm.tsx` - Form-based data input
- [ ] `UploadProgressIndicator.tsx` - Progress tracking
- [ ] `DataPreviewModal.tsx` - Review uploaded data

### Enhanced Existing Components
- [ ] Update `Layout.tsx` to support view mode switching
- [ ] Update `Navigation.tsx` to show private mode options
- [ ] Update `Dashboard.tsx` to adapt to private/public data

### Custom Hooks
- [ ] `useViewMode.ts` - Manage current view mode (public/private/combined)
- [ ] `useOrganizationContext.ts` - Current organization context
- [ ] `usePrivateOnboarding.ts` - Onboarding flow state management
- [ ] `useDataUpload.ts` - File upload and validation logic
- [ ] `useOrganizationSetup.ts` - Organization creation workflow

## User Journey Implementation (Journey 1)

### Step 1: Discovery
```typescript
// In Navigation.tsx
<ViewModeToggle 
  currentMode={viewMode}
  onModeChange={handleModeChange}
  showPrivateMode={user.isAuthenticated}
/>
```

### Step 2: Authentication Redirect
```typescript
// In ViewModeToggle.tsx
const handlePrivateModeClick = () => {
  if (!user.isAuthenticated) {
    navigate('/auth?redirect=/private');
    return;
  }
  setViewMode('private');
};
```

### Step 3: Onboarding Flow
```typescript
// In PrivateModeOnboarding.tsx
<OnboardingWizard
  steps={[
    { id: 'welcome', component: WelcomeStep },
    { id: 'organization', component: OrganizationSetupStep },
    { id: 'upload', component: DataUploadStep },
    { id: 'complete', component: CompletionStep }
  ]}
  onComplete={handleOnboardingComplete}
/>
```

### Step 4: Organization Setup
```typescript
// In OrganizationSetupWizard.tsx
<OrganizationProfileForm
  onSubmit={handleOrganizationCreate}
  validation={organizationValidationSchema}
  industries={availableIndustries}
/>
```

### Step 5: Data Upload
```typescript
// In DataUploadTutorial.tsx
<DataUploadZone
  acceptedFormats={['.csv', '.xlsx']}
  onUpload={handleFileUpload}
  maxSize={10 * 1024 * 1024} // 10MB
  validation={dataValidationSchema}
/>
```

## Database Schema Extensions

### Organization Management
```sql
-- Organization management
CREATE TABLE organizations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  industry_id UUID REFERENCES industries(id),
  size_category TEXT CHECK (size_category IN ('small', 'medium', 'large')),
  created_by UUID REFERENCES profiles(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Team member relationships
CREATE TABLE organization_members (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  organization_id UUID REFERENCES organizations(id),
  user_id UUID REFERENCES profiles(id),
  role TEXT CHECK (role IN ('owner', 'admin', 'member', 'viewer')),
  invited_at TIMESTAMPTZ DEFAULT NOW(),
  joined_at TIMESTAMPTZ,
  UNIQUE(organization_id, user_id)
);

-- Privacy preferences
CREATE TABLE organization_privacy_settings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  organization_id UUID REFERENCES organizations(id),
  share_benchmarking BOOLEAN DEFAULT false,
  share_aggregated BOOLEAN DEFAULT false,
  anonymize_data BOOLEAN DEFAULT true,
  retention_period_days INTEGER DEFAULT 2555, -- 7 years
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

## Success Metrics
- **User Adoption**: >60% of authenticated users utilize private features
- **Onboarding Completion**: >80% of users complete organization setup
- **Data Upload Success**: >90% successful data imports
- **Performance**: View mode switching <2s, data upload <30s for 10MB files 